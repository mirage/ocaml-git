OASISFormat: 0.4
Name:        git
Version:     1.2.0
Synopsis:    A low-level interface to Git in pure OCaml
Authors:     Thomas Gazagnaire
License:     ISC
Plugins:     META (0.3), DevFiles (0.3)
BuildTools:  ocamlbuild

Flag unix
  Description:       build the Unix library
  Default:           true

Flag mirage
  Description:       build the Mirage library
  Default:           false

Library git
  Pack:              true
  Path:              lib/
  Findlibname:       git
  Modules:           SHA, Blob, Cache, Commit, Misc,
                     Global_graph, Pack, Pack_index, Packed_value,
                     Reference, Sync, Tag, Tree, User, Value,
                     Object, Object_type, Store, Search, Gri,
                     Memory, FS
  BuildDepends:      mstruct, dolog, ocamlgraph,
                     re.pcre, zip, nocrypto, uri, lwt,
                     sexplib.syntax,
                     conduit.lwt, uri.services
  XMETARequires:     mstruct, dolog, ocamlgraph,
                     re.pcre, zip, nocrypto, uri, lwt,
                     conduit.lwt, uri.services

Library "git-unix"
  Build$:           flag(unix)
  Path:              lib/
  FindlibParent:     git
  Findlibname:       unix
  Modules:           Git_unix
  BuildDepends:      git, lwt.unix

Library "git-mirage"
  Build$:           flag(mirage)
  Path:              lib/
  FindlibParent:     git
  Findlibname:       mirage
  Modules:           Git_mirage
  BuildDepends:      git, mirage-types.lwt, io-page

Executable ogit
  Build$:           flag(unix)
  Path:             bin/
  MainIs:           ogit.ml
  CompiledObject:   best
  Install:          true
  BuildDepends:     cmdliner, git, git.unix

Executable test_git
  Build$:           flag(tests) && flag(unix) && flag(mirage)
  Path:             lib_test
  MainIs:           test.ml
  CompiledObject:   best
  Install:          false
  BuildDepends:     alcotest, git, git.unix,
                    git.mirage, io-page.unix, mirage-fs-unix

Test test_git
  Run$:             flag(tests) && flag(unix) && flag(mirage)
  Command:          $test_git -q
  WorkingDirectory: lib_test/
