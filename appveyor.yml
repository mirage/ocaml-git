platform:
  - x86

environment:
  global:
    CYG_ROOT: "C:\\cygwin"
    CYG_BASH: "%CYG_ROOT%\\bin\\bash -lc"
    TESTS: "false"
    EXTRA_REMOTES: "https://github.com/mirage/mirage-dev.git"
    PINS: "git.1.10.0:. git-http.1.10.0:. git-unix.1.10.0:. git-mirage.1.10.0:."
  matrix:
  - PACKAGE: "git-mirage"
  - PACKAGE: "git-unix"

install:
  - appveyor DownloadFile https://raw.githubusercontent.com/ocaml/ocaml-ci-scripts/master/appveyor-opam.sh
  - "%CYG_ROOT%\\setup-x86.exe -qnNdO -R %CYG_ROOT% -s http://cygwin.mirror.constant.com -l C:/cygwin/var/cache/setup -P rsync -P patch -P make -P unzip -P git -P perl -P mingw64-x86_64-gcc-core"

build_script:
  - "%CYG_BASH% '${APPVEYOR_BUILD_FOLDER}/appveyor-opam.sh'"
