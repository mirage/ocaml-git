<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Decoder (git.Git__Smart.Decoder)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">git</a> &#x00BB; <a href="../index.html">Git__Smart</a> &#x00BB; Decoder</nav><h1>Module <code>Git__Smart.Decoder</code></h1><p>The <i>functor</i> to make the Decoder by a specific hash implementation.</p></header><h3 class="heading">Parameters</h3><ul><li><code><a href="argument-1-Hash/index.html">Hash</a> : <a href="../../Git__/S/index.html#module-type-HASH">Git__.S.HASH</a></code></li><li><code><a href="argument-2-Reference/index.html">Reference</a> : <a href="../../Git/Reference/index.html#module-type-S">Git.Reference.S</a> <span class="keyword">with</span> <span class="keyword">module</span> <a href="argument-2-Reference/Hash/index.html">Hash</a> := <a href="index.html#argument-1-Hash">Hash</a></code></li><li><code><a href="argument-3-Common/index.html">Common</a> : <a href="../index.html#module-type-COMMON">COMMON</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="argument-3-Common/index.html#type-hash">hash</a> := <a href="index.html#argument-1-Hash">Hash</a>.t <span class="keyword">and</span> <span class="keyword">type</span> <a href="argument-3-Common/index.html#type-reference">reference</a> := <a href="argument-2-Reference/index.html#type-t">Reference.t</a></code></li></ul><h3 class="heading">Signature</h3><div class="spec module" id="module-Hash"><a href="#module-Hash" class="anchor"></a><code><span class="keyword">module</span> <a href="Hash/index.html">Hash</a> : <a href="../../Git__/S/index.html#module-type-HASH">Git__.S.HASH</a></code></div><div class="spec module" id="module-Reference"><a href="#module-Reference" class="anchor"></a><code><span class="keyword">module</span> <a href="Reference/index.html">Reference</a> : <a href="../../Git/Reference/index.html#module-type-S">Git.Reference.S</a> <span class="keyword">with</span> <span class="keyword">module</span> <a href="../../Git/Reference/module-type-S/Hash/index.html">Hash</a> := <a href="index.html#module-Hash">Hash</a></code></div><div class="spec module" id="module-Common"><a href="#module-Common" class="anchor"></a><code><span class="keyword">module</span> <a href="Common/index.html">Common</a> : <a href="../index.html#module-type-COMMON">COMMON</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../module-type-COMMON/index.html#type-hash">hash</a> := <a href="index.html#module-Hash">Hash</a>.t <span class="keyword">and</span> <span class="keyword">type</span> <a href="../module-type-COMMON/index.html#type-reference">reference</a> := <a href="Reference/index.html#type-t">Reference.t</a></code></div><dl><dt class="spec type" id="type-decoder"><a href="#type-decoder" class="anchor"></a><code><span class="keyword">type</span> decoder</code></dt><dd><p>The type decoder.</p></dd></dl><dl><dt class="spec value" id="val-pp_decoder"><a href="#val-pp_decoder" class="anchor"></a><code><span class="keyword">val</span> pp_decoder : <span><a href="index.html#type-decoder">decoder</a> Fmt.t</span></code></dt><dd><p>Pretty-printer of <a href="index.html#type-decoder"><code>decoder</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-extract_payload"><a href="#val-extract_payload" class="anchor"></a><code><span class="keyword">val</span> extract_payload : <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> Cstruct.t</code></dt></dl><dl><dt class="spec type" id="type-error"><a href="#type-error" class="anchor"></a><code><span class="keyword">type</span> error</code> = <code>[ </code><table class="variant"><tr id="type-error.Expected_char" class="anchored"><td class="def constructor"><a href="#type-error.Expected_char" class="anchor"></a><code>| </code><code>`Expected_char <span class="keyword">of</span> char</code></td><td class="doc"><p>Appears when we encountered an other character than what we expected stricly.</p></td></tr><tr id="type-error.Unexpected_char" class="anchored"><td class="def constructor"><a href="#type-error.Unexpected_char" class="anchor"></a><code>| </code><code>`Unexpected_char <span class="keyword">of</span> char</code></td><td class="doc"><p>Appears when we encountered a character and we don't know what we can do with this.</p></td></tr><tr id="type-error.Unexpected_flush_pkt_line" class="anchored"><td class="def constructor"><a href="#type-error.Unexpected_flush_pkt_line" class="anchor"></a><code>| </code><code>`Unexpected_flush_pkt_line</code></td><td class="doc"><p>Appears when we encountered a flush packet and we don't expect this.</p></td></tr><tr id="type-error.No_assert_predicate" class="anchored"><td class="def constructor"><a href="#type-error.No_assert_predicate" class="anchor"></a><code>| </code><code>`No_assert_predicate <span class="keyword">of</span> char <span>&#45;&gt;</span> bool</code></td><td class="doc"><p>Appears when one character does not respect the predicate.</p></td></tr><tr id="type-error.Expected_string" class="anchored"><td class="def constructor"><a href="#type-error.Expected_string" class="anchor"></a><code>| </code><code>`Expected_string <span class="keyword">of</span> string</code></td><td class="doc"><p>Appears when we don't have strictly the string expected.</p></td></tr><tr id="type-error.Unexpected_empty_pkt_line" class="anchored"><td class="def constructor"><a href="#type-error.Unexpected_empty_pkt_line" class="anchor"></a><code>| </code><code>`Unexpected_empty_pkt_line</code></td><td class="doc"><p>Appears when we encountered an empty packet and we don't expect this.</p></td></tr><tr id="type-error.Malformed_pkt_line" class="anchored"><td class="def constructor"><a href="#type-error.Malformed_pkt_line" class="anchor"></a><code>| </code><code>`Malformed_pkt_line</code></td><td class="doc"><p>Appears when we encountered a flow which does not respect the packet format.</p></td></tr><tr id="type-error.Unexpected_end_of_input" class="anchored"><td class="def constructor"><a href="#type-error.Unexpected_end_of_input" class="anchor"></a><code>| </code><code>`Unexpected_end_of_input</code></td></tr><tr id="type-error.Unexpected_pkt_line" class="anchored"><td class="def constructor"><a href="#type-error.Unexpected_pkt_line" class="anchor"></a><code>| </code><code>`Unexpected_pkt_line</code></td></tr><tr id="type-error.Unexpected_hashes" class="anchored"><td class="def constructor"><a href="#type-error.Unexpected_hashes" class="anchor"></a><code>| </code><code>`Unexpected_hashes <span class="keyword">of</span> <a href="index.html#module-Hash">Hash</a>.t * <a href="index.html#module-Hash">Hash</a>.t</code></td></tr></table><code> ]</code></dt><dd><p>The type error.</p></dd></dl><dl><dt class="spec value" id="val-pp_error"><a href="#val-pp_error" class="anchor"></a><code><span class="keyword">val</span> pp_error : <span><a href="index.html#type-error">error</a> Fmt.t</span></code></dt><dd><p>Pretty-printer of <a href="index.html#type-error"><code>error</code></a>.</p></dd></dl><dl><dt class="spec type" id="type-state"><a href="#type-state" class="anchor"></a><code><span class="keyword">type</span> <span>'a state</span></code><code> = </code><table class="variant"><tr id="type-state.Ok" class="anchored"><td class="def constructor"><a href="#type-state.Ok" class="anchor"></a><code>| </code><code><span class="constructor">Ok</span> <span class="keyword">of</span> <span class="type-var">'a</span></code></td><td class="doc"><p>The end value of the decoding.</p></td></tr><tr id="type-state.Read" class="anchored"><td class="def constructor"><a href="#type-state.Read" class="anchor"></a><code>| </code><code><span class="constructor">Read</span> <span class="keyword">of</span> </code><code>{</code><table class="record"><tr id="type-state.buffer" class="anchored"><td class="def field"><a href="#type-state.buffer" class="anchor"></a><code>buffer : Cstruct.t;</code></td></tr><tr id="type-state.off" class="anchored"><td class="def field"><a href="#type-state.off" class="anchor"></a><code>off : int;</code></td></tr><tr id="type-state.len" class="anchored"><td class="def field"><a href="#type-state.len" class="anchor"></a><code>len : int;</code></td></tr><tr id="type-state.continue" class="anchored"><td class="def field"><a href="#type-state.continue" class="anchor"></a><code>continue : int <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-state">state</a></span>;</code></td></tr></table><code>}</code></td><td class="doc"><p>Means that we expect an input. We provide an <span class="xref-unresolved" title="unresolved reference to &quot;Cstruct.t&quot;"><code>Cstruct</code>.t</span> with an offset and a length. The client is able to <span class="xref-unresolved" title="unresolved reference to &quot;Cstruct.blit&quot;"><code>Cstruct</code>.blit</span> the input in this range. Then, he can call <code>continue</code> with how many byte(s) he read.</p></td></tr><tr id="type-state.Error" class="anchored"><td class="def constructor"><a href="#type-state.Error" class="anchor"></a><code>| </code><code><span class="constructor">Error</span> <span class="keyword">of</span> </code><code>{</code><table class="record"><tr id="type-state.err" class="anchored"><td class="def field"><a href="#type-state.err" class="anchor"></a><code>err : <a href="index.html#type-error">error</a>;</code></td></tr><tr id="type-state.buf" class="anchored"><td class="def field"><a href="#type-state.buf" class="anchor"></a><code>buf : Cstruct.t;</code></td></tr><tr id="type-state.committed" class="anchored"><td class="def field"><a href="#type-state.committed" class="anchor"></a><code>committed : int;</code></td></tr></table><code>}</code></td><td class="doc"><p>When we retrieve an error, we return this value with how many byte(s) we processed and the current input.</p></td></tr></table></dt><dt class="spec type" id="type-transaction"><a href="#type-transaction" class="anchor"></a><code><span class="keyword">type</span> <span>_ transaction</span></code><code> = </code><table class="variant"><tr id="type-transaction.HttpReferenceDiscovery" class="anchored"><td class="def constructor"><a href="#type-transaction.HttpReferenceDiscovery" class="anchor"></a><code>| </code><code><span class="constructor">HttpReferenceDiscovery</span> : string <span>&#45;&gt;</span> <span><span><span>(<a href="Common/index.html#type-advertised_refs">Common.advertised_refs</a>, <span>[ <span>`Msg of string</span> ]</span>)</span> Stdlib.result</span> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.ReferenceDiscovery" class="anchored"><td class="def constructor"><a href="#type-transaction.ReferenceDiscovery" class="anchor"></a><code>| </code><code><span class="constructor">ReferenceDiscovery</span> : <span><span><span>(<a href="Common/index.html#type-advertised_refs">Common.advertised_refs</a>, <span>[ <span>`Msg of string</span> ]</span>)</span> Stdlib.result</span> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.ShallowUpdate" class="anchored"><td class="def constructor"><a href="#type-transaction.ShallowUpdate" class="anchor"></a><code>| </code><code><span class="constructor">ShallowUpdate</span> : <span><a href="Common/index.html#type-shallow_update">Common.shallow_update</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.Negociation" class="anchored"><td class="def constructor"><a href="#type-transaction.Negociation" class="anchor"></a><code>| </code><code><span class="constructor">Negociation</span> : <a href="Hash/index.html#module-Set">Hash.Set</a>.t * <a href="index.html#type-ack_mode">ack_mode</a> <span>&#45;&gt;</span> <span><a href="Common/index.html#type-acks">Common.acks</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.NegociationResult" class="anchored"><td class="def constructor"><a href="#type-transaction.NegociationResult" class="anchor"></a><code>| </code><code><span class="constructor">NegociationResult</span> : <span><a href="Common/index.html#type-negociation_result">Common.negociation_result</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.PACK" class="anchored"><td class="def constructor"><a href="#type-transaction.PACK" class="anchor"></a><code>| </code><code><span class="constructor">PACK</span> : <a href="index.html#type-side_band">side_band</a> <span>&#45;&gt;</span> <span><a href="index.html#type-flow">flow</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.ReportStatus" class="anchored"><td class="def constructor"><a href="#type-transaction.ReportStatus" class="anchor"></a><code>| </code><code><span class="constructor">ReportStatus</span> : <span>string list</span> * <a href="index.html#type-side_band">side_band</a> <span>&#45;&gt;</span> <span><a href="Common/index.html#type-report_status">Common.report_status</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.HttpReportStatus" class="anchored"><td class="def constructor"><a href="#type-transaction.HttpReportStatus" class="anchor"></a><code>| </code><code><span class="constructor">HttpReportStatus</span> : <span>string list</span> * <a href="index.html#type-side_band">side_band</a> <span>&#45;&gt;</span> <span><a href="Common/index.html#type-report_status">Common.report_status</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.Upload_request" class="anchored"><td class="def constructor"><a href="#type-transaction.Upload_request" class="anchor"></a><code>| </code><code><span class="constructor">Upload_request</span> : <span><a href="Common/index.html#type-upload_request">Common.upload_request</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.Git_proto_request" class="anchored"><td class="def constructor"><a href="#type-transaction.Git_proto_request" class="anchor"></a><code>| </code><code><span class="constructor">Git_proto_request</span> : <span><a href="Common/index.html#type-git_proto_request">Common.git_proto_request</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr><tr id="type-transaction.Update_request" class="anchored"><td class="def constructor"><a href="#type-transaction.Update_request" class="anchor"></a><code>| </code><code><span class="constructor">Update_request</span> : <span><a href="Common/index.html#type-update_request">Common.update_request</a> <a href="index.html#type-transaction">transaction</a></span></code></td></tr></table></dt><dd><p>The type transaction to describe what is expected to decode/receive.</p></dd></dl><dl><dt class="spec type" id="type-ack_mode"><a href="#type-ack_mode" class="anchor"></a><code><span class="keyword">and</span> ack_mode</code> = <code>[ </code><table class="variant"><tr id="type-ack_mode.Ack" class="anchored"><td class="def constructor"><a href="#type-ack_mode.Ack" class="anchor"></a><code>| </code><code>`Ack</code></td></tr><tr id="type-ack_mode.Multi_ack" class="anchored"><td class="def constructor"><a href="#type-ack_mode.Multi_ack" class="anchor"></a><code>| </code><code>`Multi_ack</code></td></tr><tr id="type-ack_mode.Multi_ack_detailed" class="anchored"><td class="def constructor"><a href="#type-ack_mode.Multi_ack_detailed" class="anchor"></a><code>| </code><code>`Multi_ack_detailed</code></td></tr></table><code> ]</code></dt><dd><p>The ACK mode type to describe which mode is shared by the client and the server.</p></dd></dl><dl><dt class="spec type" id="type-flow"><a href="#type-flow" class="anchor"></a><code><span class="keyword">and</span> flow</code> = <code>[ </code><table class="variant"><tr id="type-flow.Raw" class="anchored"><td class="def constructor"><a href="#type-flow.Raw" class="anchor"></a><code>| </code><code>`Raw <span class="keyword">of</span> Cstruct.t</code></td></tr><tr id="type-flow.End" class="anchored"><td class="def constructor"><a href="#type-flow.End" class="anchor"></a><code>| </code><code>`End</code></td></tr><tr id="type-flow.Err" class="anchored"><td class="def constructor"><a href="#type-flow.Err" class="anchor"></a><code>| </code><code>`Err <span class="keyword">of</span> Cstruct.t</code></td></tr><tr id="type-flow.Out" class="anchored"><td class="def constructor"><a href="#type-flow.Out" class="anchor"></a><code>| </code><code>`Out <span class="keyword">of</span> Cstruct.t</code></td></tr></table><code> ]</code></dt><dd><p>The representation of the output side-band.</p></dd></dl><dl><dt class="spec type" id="type-side_band"><a href="#type-side_band" class="anchor"></a><code><span class="keyword">and</span> side_band</code> = <code>[ </code><table class="variant"><tr id="type-side_band.Side_band" class="anchored"><td class="def constructor"><a href="#type-side_band.Side_band" class="anchor"></a><code>| </code><code>`Side_band</code></td></tr><tr id="type-side_band.Side_band_64k" class="anchored"><td class="def constructor"><a href="#type-side_band.Side_band_64k" class="anchor"></a><code>| </code><code>`Side_band_64k</code></td></tr><tr id="type-side_band.No_multiplexe" class="anchored"><td class="def constructor"><a href="#type-side_band.No_multiplexe" class="anchor"></a><code>| </code><code>`No_multiplexe</code></td></tr></table><code> ]</code></dt><dd><p>The side-band mode type to describe which mode is shared by the client and the server.</p></dd></dl><dl><dt class="spec value" id="val-decode"><a href="#val-decode" class="anchor"></a><code><span class="keyword">val</span> decode : <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span><span class="type-var">'result</span> <a href="index.html#type-transaction">transaction</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'result</span> <a href="index.html#type-state">state</a></span></code></dt><dd><p><code>decode decoder transaction</code> decodes the input represented by <code>decoder</code> in the way of the <code>transaction</code> and returns the value expected and described by <code>transaction</code> or an error.</p></dd></dl><dl><dt class="spec value" id="val-decoder"><a href="#val-decoder" class="anchor"></a><code><span class="keyword">val</span> decoder : unit <span>&#45;&gt;</span> <a href="index.html#type-decoder">decoder</a></code></dt><dd><p><code>decoder ()</code> makes a new decoder.</p></dd></dl><dl><dt class="spec value" id="val-of_string"><a href="#val-of_string" class="anchor"></a><code><span class="keyword">val</span> of_string : string <span>&#45;&gt;</span> <span><span class="type-var">'v</span> <a href="index.html#type-transaction">transaction</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'v</span>, <a href="index.html#type-error">error</a> * Cstruct.t * int)</span> Stdlib.result</span></code></dt></dl></div></body></html>