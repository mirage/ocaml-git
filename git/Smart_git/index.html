<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Smart_git (git.Smart_git)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">git</a> &#x00BB; Smart_git</nav><header class="odoc-preamble"><h1>Module <code><span>Smart_git</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#mimic-values.">Mimic values.</a></li></ul></nav><div class="odoc-content"><div class="odoc-include"><div class="odoc-spec"><div class="spec module-type" id="module-type-APPEND" class="anchored"><a href="#module-type-APPEND" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> </span><span><a href="module-type-APPEND/index.html">APPEND</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-UID" class="anchored"><a href="#module-type-UID" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> </span><span><a href="module-type-UID/index.html">UID</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-HTTP" class="anchored"><a href="#module-type-HTTP" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> </span><span><a href="module-type-HTTP/index.html">HTTP</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Endpoint" class="anchored"><a href="#module-Endpoint" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Endpoint/index.html">Endpoint</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h4 id="mimic-values."><a href="#mimic-values." class="anchor"></a>Mimic values.</h4><p>When the user use an <code>Endpoint.t</code> to <a href="Make/index.html#val-fetch"><code>Make.fetch</code></a> or <a href="Make/index.html#val-push"><code>Make.push</code></a>, we fill the given Mimic's <code>ctx</code> with some available informations such as:</p><ul><li>if we want to <a href="Make/index.html#val-fetch"><code>Make.fetch</code></a> (<code>`Rd</code>) or <a href="Make/index.html#val-push"><code>Make.push</code></a> (<code>`Wr</code>)</li><li>the scheme/protocol that the user would like to use (<code>git://</code>, SSH or HTTP - with or without TLS)</li><li>the path of the git repository</li><li>the host (an IP adress or a domain name)</li><li>the SSH user iff the user would like to use SSH</li><li>the port that the user would like to use</li></ul><p>From this informations, the <b>end</b>-user can process them through the Mimic API (with <code>Mimic</code>.fold) and describe how to create needed values to start <i>a</i> protocol from them.</p><p>For example, if the user wants to use <code>mirage-tcpip</code> which needs an IP address and a port, he is able to re-use/map/fold <code>git_host</code> and <a href="#val-git_port"><code>git_port</code></a> to craft what <code>mirage-tcpip</code> really needs.</p><p>Of course, such job is definitely outside the scope of <code>ocaml-git</code> and permits to us to be free about protocol implementations. An example of the plumbing needed is able with <code>git-mirage</code> which re-use these values to be able to start a <code>mirage-tcpip</code> connection, a <code>awa-ssh</code> connection of a <code>cohttp</code> (with or without <code>ocaml-tls</code>) connection.</p><div class="odoc-spec"><div class="spec type" id="type-handshake" class="anchored"><a href="#type-handshake" class="anchor"></a><code><span><span class="keyword">type</span> handshake</span><span> = <span>uri0:<span class="xref-unresolved">Uri</span>.t <span class="arrow">&#45;&gt;</span></span> <span>uri1:<span class="xref-unresolved">Uri</span>.t <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Mimic</span>.flow <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-git_capabilities" class="anchored"><a href="#val-git_capabilities" class="anchor"></a><code><span><span class="keyword">val</span> git_capabilities : <span><span>[ `Rd <span>| `Wr</span> ]</span> <span class="xref-unresolved">Mimic</span>.value</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-git_scheme" class="anchored"><a href="#val-git_scheme" class="anchor"></a><code><span><span class="keyword">val</span> git_scheme : <span><span>[ `Git <span>| `SSH</span> <span>| `HTTP</span> <span>| `HTTPS</span> <span><span>| `Scheme</span> of string</span> ]</span> <span class="xref-unresolved">Mimic</span>.value</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-git_path" class="anchored"><a href="#val-git_path" class="anchor"></a><code><span><span class="keyword">val</span> git_path : <span>string <span class="xref-unresolved">Mimic</span>.value</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-git_hostname" class="anchored"><a href="#val-git_hostname" class="anchor"></a><code><span><span class="keyword">val</span> git_hostname : <span>string <span class="xref-unresolved">Mimic</span>.value</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-git_ssh_user" class="anchored"><a href="#val-git_ssh_user" class="anchor"></a><code><span><span class="keyword">val</span> git_ssh_user : <span>string <span class="xref-unresolved">Mimic</span>.value</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-git_port" class="anchored"><a href="#val-git_port" class="anchor"></a><code><span><span class="keyword">val</span> git_port : <span>int <span class="xref-unresolved">Mimic</span>.value</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-git_http_headers" class="anchored"><a href="#val-git_http_headers" class="anchor"></a><code><span><span class="keyword">val</span> git_http_headers : <span><span><span>(string * string)</span> list</span> <span class="xref-unresolved">Mimic</span>.value</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-git_transmission" class="anchored"><a href="#val-git_transmission" class="anchor"></a><code><span><span class="keyword">val</span> git_transmission : <span><span>[ `Git <span>| `Exec</span> <span><span>| `HTTP</span> of <span class="xref-unresolved">Uri</span>.t * <a href="#type-handshake">handshake</a></span> ]</span> <span class="xref-unresolved">Mimic</span>.value</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-git_uri" class="anchored"><a href="#val-git_uri" class="anchor"></a><code><span><span class="keyword">val</span> git_uri : <span><span class="xref-unresolved">Uri</span>.t <span class="xref-unresolved">Mimic</span>.value</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Make" class="anchored"><a href="#module-Make" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Make/index.html">Make</a></span><span> (<a href="Make/argument-1-Scheduler/index.html">Scheduler</a> : <a href="../Sigs/module-type-SCHED/index.html">Sigs.SCHED</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <span>+'a <a href="../Sigs/module-type-SCHED/index.html#type-s">s</a></span> = <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span></span>) (<a href="Make/argument-2-Pack/index.html">Pack</a> : <a href="module-type-APPEND/index.html">APPEND</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <span>+'a <a href="module-type-APPEND/index.html#type-fiber">fiber</a></span> = <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span></span>) (<a href="Make/argument-3-Index/index.html">Index</a> : <a href="module-type-APPEND/index.html">APPEND</a> <span class="keyword">with</span> <span><span class="keyword">type</span>
<span>+'a <a href="module-type-APPEND/index.html#type-fiber">fiber</a></span> = <span><span class="type-var">'a</span> <span class="xref-unresolved">Lwt</span>.t</span></span>) (<a href="Make/argument-4-Uid/index.html">Uid</a> : <a href="module-type-UID/index.html">UID</a>) (<a href="Make/argument-5-Ref/index.html">Ref</a> : <a href="../Sigs/module-type-REF/index.html">Sigs.REF</a>) : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div></div></body></html>